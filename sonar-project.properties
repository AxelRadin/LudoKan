#############################
# SonarCloud - LudoKan
#############################

sonar.host.url=https://sonarcloud.io
sonar.projectName=LudoKan
sonar.sourceEncoding=UTF-8

# Les clés organisation / projectKey sont passées par le workflow GitHub Actions :
#   -Dsonar.organization=${{ secrets.SONAR_ORG }}
#   -Dsonar.projectKey=${{ secrets.SONAR_PROJECT_KEY }}
# Si tu veux lancer un scan local, tu peux aussi définir :
# sonar.organization=ton_org
# sonar.projectKey=ton_project_key

#############################
# Sources & tests
#############################

# On scanne backend + frontend (code applicatif React uniquement)
sonar.sources=backend,frontend/src

# On garde les dossiers de tests déclarés comme tests pour Sonar
sonar.tests=backend,frontend/src

# Fichiers explicitement considérés comme tests
sonar.test.inclusions=\
  backend/**/test_*.py,\
  backend/**/*_test.py,\
  backend/**/tests/**,\
  frontend/src/**/*.test.ts,\
  frontend/src/**/*.test.tsx,\
  frontend/src/**/*.spec.ts,\
  frontend/src/**/*.spec.tsx

#############################
# Exclusions d'analyse
#############################

# Ces chemins sont entièrement ignorés par Sonar (pas d'analyse, pas de coverage)
sonar.exclusions=\
  **/migrations/**,\
  **/node_modules/**,\
  **/dist/**,\
  **/build/**,\
  **/.venv/**,\
  backend/htmlcov/**,\
  backend/staticfiles/**,\
  backend/media/**,\
  frontend/dist/**,\
  frontend/node_modules/**

#############################
# Rapports de couverture
#############################

# Backend (pytest-cov) : généré dans backend/coverage.xml par la CI
sonar.python.coverage.reportPaths=backend/coverage.xml

# Frontend (lcov) : À ACTIVER UNIQUEMENT quand tu auras un rapport lcov.info
# et un job CI qui le génère + upload.
# Pour l'instant, on commente pour éviter un 0% artificiel côté JS/TS.
# sonar.javascript.lcov.reportPaths=frontend/coverage/lcov.info

#############################
# Exclusions de couverture
#############################

# Ces fichiers restent analysés (bugs/smells/etc.) mais sont ignorés des % de couverture
sonar.coverage.exclusions=\
  backend/manage.py,\
  backend/run_tests.py,\
  backend/setup_env.py,\
  backend/config/**,\
  backend/**/migrations/**,\
  backend/**/tests/**,\
  backend/**/tests.py,\
  backend/**/admin.py,\
  backend/**/apps.py,\
  backend/**/wsgi.py,\
  backend/**/asgi.py,\
  backend/**/celery.py,\
  backend/**/settings.py,\
  backend/**/urls.py,\
  backend/test_celery.py,\
  backend/tests/**,\
  backend/coverage.xml,\
  frontend/src/main.tsx,\
  frontend/src/vite-env.d.ts,\
  frontend/src/**/*.d.ts,\
  frontend/src/**/index.ts,\
  frontend/src/**/index.tsx,\
  frontend/src/theme.ts,\
  frontend/src/monitoring/**,\
  frontend/src/assets/**,\
  frontend/src/**/*.stories.tsx,\
  frontend/src/**/*.stories.ts,\
  frontend/src/**

#############################
# Astuces pratiques
#############################

# Pour ignorer TOUT le coverage frontend (mais garder l'analyse), tu peux ajouter :
#   frontend/src/**
# dans sonar.coverage.exclusions ou passer à la volée :
#   -Dsonar.coverage.exclusions=frontend/src/**


